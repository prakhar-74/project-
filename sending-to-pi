import serial
import socket

SERIAL_PORT = 'COM3'  # Change this to your Arduino port (e.g., COM5 or /dev/ttyUSB0)
BAUD = 9600
PI_IP = '172.20.10.11'  # Replace with your Raspberry Piâ€™s IP address
PI_PORT = 9999

# Connect to Arduino
ser = serial.Serial(SERIAL_PORT, BAUD, timeout=1)

# Connect to Raspberry Pi
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print("Connecting to Raspberry Pi...")
sock.connect((PI_IP, PI_PORT))
print("Connected!")

# Main loop: read from Arduino and send to Pi
while True:
    if ser.in_waiting:
        line = ser.readline().decode('utf-8').strip()
        if line.startswith("EVENT:"):  # Only send formatted data
            print(f"Sending: {line}")
            sock.sendall((line + '\n').encode('utf-8'))
